<% content_for :head do %>
<link type="text/css" href="/stylesheets/theme/ui.all.css" rel="Stylesheet" />
<script type="text/javascript" src="/javascripts/jquery.js"></script>
<script type="text/javascript" src="/javascripts/jquery_ui.js"></script>
<script type="text/javascript" src="/javascripts/application.js"></script>
<% end %>

<% title "Maintenances" %>


<% form_for @search do |f| %>
  <fieldset>
    <legend>
      Search Criteria
    </legend>
      <%= f.label :equipment_id_is, 'Equipment' %>
      <%= f.collection_select :equipment_id_is, Equipment.all, :id, :name, { :include_blank => true } %>
      &nbsp;&nbsp;&nbsp;&nbsp;
      
      <%= f.label :scheduled_date_at_after, "Scheduled between" %>
      <%= f.text_field :scheduled_date_at_after, :size => 10, :class => 'date' %>
      
      <%= f.label :scheduled_date_at_before, "and" %>
      <%= f.text_field :scheduled_date_at_before, :size => 10, :class => 'date' %>
    </p>

    <p>
      <%= f.label :service_type_is,  'Type' %>
      <%= f.select :service_type_is, Maintenance::SERVICE_TYPES, { :include_blank => true } %>
      
      &nbsp;&nbsp;&nbsp;&nbsp;
      <!-- Todo Fix it   -->
      <%= f.label :status, 'Status:' %>
      <%= f.radio_button :status, 'pending' %> Pending
      <%= f.radio_button :status, 'proposed'  %> Proposed
      <%= f.radio_button :status, 'completed'  %> Completed
      <%= f.radio_button :status, 'refused' %> Refused
    </p>
    <p>
      <%= f.label :client_id_is, 'Client' %>
      <%= f.collection_select :client_id_is, Client.all, :id, :name, { :include_blank => true } %>
      &nbsp;&nbsp;&nbsp;&nbsp;
      <%= f.label :technician_id_is, 'Technician' %>
      <%= f.collection_select :technician_id_is, Technician.all, :id, :name, { :include_blank => true } %>
    </p>
    <p>
      <%= f.label :note_contains %>
      <%= f.text_field :note_contains %>
    </p>
  </fieldset>
  <p class="button"><%= f.submit %></p>
<% end %>

<br/>
<table border="1" cellpadding="0">
  <tr>
    <th>Equipment</th>
    <th>Status</th>
    <th>Service Type</th>
    <th>Client</th>
    <th>Technician</th>
    <th>Scheduled Date At</th>
  </tr>
  <% for maintenance in @maintenances %>
    <tr>
      <td><%=h maintenance.equipment_name %></td>
      <td><%=h maintenance.status %></td>      
      <td><%=h maintenance.service_type %></td>      
      <td><%=h maintenance.client_name %></td>
      <td><%=h maintenance.technician_name unless maintenance.technician_id.nil? %></td>
      <td><%=h maintenance.scheduled_date_at %></td>
      <td><%= link_to "Show", maintenance %></td>
    </tr>
  <% end %>
</table>

<p><%= link_to "New Maintenance", new_maintenance_path %></p>
